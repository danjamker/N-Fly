1. Introduction
Evidence is accumulating to suggest that the concept of molecular surfaces is in many cases only meaningful when all interaction partners are considered. This is due to the flexible nature of protein structures and induced conformational changes during complex formation [1]. The study of static molecular surfaces of isolated small molecules, proteins and other macromolecules, however, remains a very popular and powerful approach to address questions concerning molecular recognition and functional analysis. Several methods have been developed for this purpose. Spherical harmonics have been used for the visualisation of molecular surfaces [2] and [3] and more recently, developments have elegantly extended the method to enable shape and charge comparisons for protein–protein docking [4] and [5]. Following the original work of Ritchie and Kemp [4], spherical harmonic expansion coefficients have been used to directly describe and compare the shapes of binding pockets for virtual screening [6] and [7]. The main advantages of using spherical harmonics are that the method is analytical with a clear control on the level of detail, has relatively few parameters, it is unique in that different shapes have different expansion coefficients, and it allows for physical-chemical properties to be described within the same framework. The use of spherical harmonics in the molecular sciences is, therefore, widespread [2], [3], [4], [5], [6], [7], [8], [9], [10], [11], [12], [13], [14], [15], [16], [17], [18], [19], [20] and [21]. 
Harmonics are solutions of Laplace's equation. Spherical harmonics are solutions to the angular part of Laplace's equation in spherical coordinates (r,?,) and can be defined as

where l and m (?l?m?+l) are function indices and Plm associated Legendre polynomials. Spherical harmonics form a complete set of orthonormal functions on the unit sphere, S2. Thus, any function f on S2 expressed in spherical coordinates, (,?)[0,2?)×[0,?], can be represented exactly as a series of spherical harmonics,

The computation of the expansion coefficients, clm, requires integration over the solid angle on the full sphere S2 of the function being represented, f, and the complex-conjugate spherical harmonic of the same indices, l and m,

Analytical expressions for the surface of molecules exist, but typically the integration is carried out numerically. Numerical multidimensional integration is far from trivial—see [22] for a brief discussion and references within for further details—and can be a time-consuming and error-prone procedure. The complexity of this numerical integration is proportional to the number of sample points used. Also, the ease with which the cubature weights can be computed is highly dependent on the number of chosen points, due to the multi-minima nature of the typical objective functions used for their determination. 
The Nyquist–Shannon sampling theorem states that to resolve features of frequency ? one must sample at, at least, 2?. The same argument applies in Fourier space, so to resolve spatial features of a given distance, one must sample at half that distance. To represent atomic details of proteins can, therefore, require a very large number of surface sample points, depending, of course, on the total surface area. Faithfully reproducing these atomic details with spherical harmonics makes an expansion to high order of l necessary, often well above 40. However, for visualisation purposes and even more so for shape-matching it is often sufficient to terminate the expansion below 16. We found that for shape classification, lmax=8 often provided adequate detail, see [7] and Fig. 1 and Fig. 2 , which show the reconstruction of two molecules using a spherical harmonic approximation. Unless the expansion is really required to higher orders, sampling the surface in the detail in which it is commonly performed by standard integration techniques (often many thousands of sample points) is rarely justified. 
Fig. 1. Spherical harmonic approximations to the shape of nicotinamide adenine dinucleotide (NAD) in a given conformation. From left to right, lmax=4, lmax=8, lmax=16, and the van der Waals surface. Images produced with Pymol [32]. 
Fig. 2. Spherical harmonic approximations to the shape of endoglucanase CelA (PDB ID 1is9, [30]). From left to right, lmax=4, lmax=8, lmax=16, and the van der Waals surface. Images produced with Pymol [32]. 
For the development of a fast shape-matching method [7], we needed to evaluate the quality of our shape approximations. The integration step for the determination of the expansion coefficients can play a crucial role in the performance, both in execution time and numerical accuracy. In this article, a comparison over a large set of optimal and near-optimal cubature formulæis presented for a number of molecular surfaces generated at various degrees of resolution. 
2. Spherical cubature formulæ
One method for the computation of spherical harmonic expansion coefficients requires a least-square fit to a set of points obtained from over-sampling (relative to the sufficient Nyquist–Shannon frequency) the surface [2] and [6]. For cases in which the data are not too noisy or an over-sampling of the surface is not practical, a more elegant approach for the computation of the expansion coefficients exists. This approach follows Eq. 3 and involves the numerical integration of the function to be expanded over S2. Numerical integration on the sphere is straightforward, in principle, following standard integration procedures. The implementation, however, reveals a number of difficulties and with insufficient care for the details, this step can become highly sensitive towards the integration sample points and their weights as well at becoming unnecessarily time consuming. Cubature formulae for the sphere have therefore deservedly been given dedicated research focus. By cubature formulae we mean a set of points with the appropriate weights such that an integral over this space can be computed by a weighted sum of point evaluations. 
The problem of finding good cubature formulae on the sphere [23] is related to Fejes Tóth's and Thomson's problem, the facility dispersion problem and multivariate Gaussian quadrature. Fejes Tóth's problem addresses how N points can be distributed on the unit sphere such that they maximise the minimum distance between any pair of points. Thomson's problem may be described as how to determine a stable equilibrium of N point charges constrained on the surface of a sphere. The inverse square charge repulsion forces the charges to also maximise the minimum distance between any two points. Although mathematically equivalent to Tóth's problem, a physical system of point charges cannot be held in stable equilibrium by their electrostatic interactions alone. This is known as Earnshaw's theorem. Despite their apparent simplicity and broad range of applications, these are in general still unsolved problems. 
An arrangement of N points on a sphere that corresponds to the placement of N identical non-overlapping spheres around another sphere is called a sphere packing. The configuration of such points is called a spherical code. The number of spheres that touch an equivalent sphere is called the kissing number. See [24] for an introduction to sampling methods and the references within for more in-depth presentations. 
A spherical design of strength t (spherical t-design) describes the placement of N points on the unit sphere such that all points have equal numerical integration weights [25]. Mathematically, a set of points, , is a spherical t-design on Sd?1 if and only if it is possible to exactly determine the average value on Sd?1 of any polynomial f of degree at most t by sampling f at the points of X,

Sd?1 is the (d?1)-dimensional surface of a unit sphere in d dimensions and is a uniform normalised measure on the sphere Sd?1. Although spherical t-designs are proven to exist only for rather low degrees, (up to t=12 corresponding to N?48 sample points), there is strong numerical evidence to suggest that point layouts can be found up to t=21 with equal weights [26]. 
Fliege and Maier [27] have explored cubature formulae that are not spherical t-designs but have near-equal weights. Relaxing the strict requirement for equal integration weights allows significantly higher orders to be explored. Fliege and Maier have published point sets on S2 up to N=900. They use a two-stage approach to determine the points and their weights. First, a good approximation of the multi-minima Thomson problem is sought using simulated annealing. The resulting configuration is then fine-tuned using the L-BFGS algorithm and the weights are calculated. A similar approach can be found in Morris et al. [28] that uses a genetic algorithm. 
When studying only one function at a time on S2, some cubature formulae perform astonishingly well and are often capable of achieving individual accuracies of the same order of magnitude as machine precision for the integration of simple functions on the sphere. However, for spherical harmonic expansions one is faced with an additional complication in that to reconstruct surface points, one requires not one integration on the sphere but expansion coefficients. A few small errors in only some of these coefficients can quickly accumulate into large errors. Therefore, an evaluation of any cubature formula for molecular surfaces should be based on a full image reconstruction and not individual coefficient accuracies as these can be misleading. 
3. Results
We have performed the following experiment to test the integration layouts of Hardin and Sloane [26] and Fliege and Maier [27]. We first expanded various molecular surfaces (proteins and ligands), as defined by their solvent accessible surface area, in real spherical harmonics up to lmax=20. We then applied a high-frequency filter to lose the finer details by setting the coefficients above a chosen lmax to zero. This was performed in the lmax range of 4–20. For each of theses medium to low resolution molecular surfaces, we tested the full range of integration schemes—18 spherical t-designs ranging from 16 to 240 points proposed by Hardin and Sloane [26] and 26 spherical designs ranging from 16 to 841 points proposed by Fliege and Maier [27] —to evaluate the accuracy with which these shapes could be expanded in spherical harmonics and reconstructed from their coefficients that were computed with each integration layout. 
We evaluated the accuracy of the cubature formulae by computing the summed squared differences between the reconstructed molecular surfaces from the terminated original expansion and those computed from the coefficients obtained using the cubature formulæ,

These values were computed at 900 sample points that were not used during integration. To eliminate size bias, we normalised all expansion coefficients by the first spherical harmonic expansion coefficient prior to the reconstruction. This is equivalent to normalising the mean square error by the radius of the molecule (zeroth order shape approximation), thus making the units equal to Å2/Å=Å. This normalisation procedure produces remarkably consistent curves, see Fig. 3 and Fig. 4 , which were calculated for ligands and proteins, respectively, for the spherical t-designs of Hardin and Sloane [26]. These plots show the normalised mean square error between the original surface of degree lmax and the reconstructed surface from a spherical harmonics expansion computed using various cubature formulæversus the expansion order. These plots highlight the situations in which the designs deviate from the exact solution. Given an acceptable average error tolerance, zooming in on such plots allows one to choose the optimal (minimal number of points for a given error tolerance) integration layout, Fig. 5. In Fig. 3, the original surface was computed from nicotinamide adenine dinucleotide, NAD, (taken from 1heu, [29]). Fig. 4 shows a similar plot calculated using the molecular surface from Endoglucanase CelA (taken from 1is9, [30]). Fig. 6 shows an evaluation of the Fliege and Maier [27] integration nodes. These plots show that impressive normalised mean square errors in the region of 10?5 Å are achievable all the way up to lmax=20 with not much more than a few hundred integration points. 
Fig. 3. The quality of spherical t-designs [26] for spherical harmonic expansions for the small molecule NAD. The normalised mean square error between the original surface of degree lmax and the reconstructed surface from a spherical harmonics expansion using various cubature formulævs. the expansion order is shown. N is the number of points of the spherical designs. 
. 
